<!-- <!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Form Builder</title>
    <link rel="stylesheet" href="../css/edit.css">
</head>
<body>
    <div class="container">
        <div class="editor" id="editor">
            <p class="text-sm text-muted">Drag and drop elements here</p>
            <div class="dropzone" id="dropzone"></div>
            <div class="button-group">
                <button id="saveForm">Save</button>
                <button id="previewForm">Preview</button>
                <button id="exportXML">Export XML</button>
                <input type="file" id="importXML" accept=".xml">
            </div>
            <div class="top-right-buttons">
                <button id="previewForm">Preview</button>
                <button id="saveForm">Save</button>
                <button id="exportXML   ">Save as XML</button>
              </div>
        </div>
        <div class="sidebar" id="sidebar">
            <div id="elements-list">
                <p class="text-sm text-muted">Drag and drop elements</p>
                <div class="separator"></div>
                <div class="grid">
                    <p class="text-sm text-muted col-span-1">Layout elements</p>
                    <div class="draggable" draggable="true" data-element="Title Field">Title Field</div>
                    <div class="draggable" draggable="true" data-element="SubTitle Field">SubTitle Field</div>
                    <div class="draggable" draggable="true" data-element="Paragraph Field">Paragraph Field</div>
                    <div class="draggable" draggable="true" data-element="Separator">Separator</div>
                    <div class="draggable" draggable="true" data-element="Spacer">Spacer</div>

                    <p class="text-sm text-muted col-span-1">Form elements</p>
                    <div class="draggable" draggable="true" data-element="Text Field">Text Field</div>
                    <div class="draggable" draggable="true" data-element="Number Field">Number Field</div>
                    <div class="draggable" draggable="true" data-element="Text Area Field">Text Area Field</div>
                    <div class="draggable" draggable="true" data-element="Date Field">Date Field</div>
                    <div class="draggable" draggable="true" data-element="Select Field">Select Field</div>
                    <div class="draggable" draggable="true" data-element="Checkbox Field">Checkbox Field</div>
                    <div class="draggable" draggable="true" data-element="Button Field">Button Field</div>
                    <div class="draggable" draggable="true" data-element="Table Field">Table Field</div>
                </div>
            </div>
            <div id="element-settings" class="element-settings" style="display:none;">
                <h3>Element Settings</h3>
                <div id="settings-content">
                    <p class="text-muted">Click on an element to edit its settings</p>
                </div>
            </div>
        </div>
    </div>

    <script src="../js/edit.js"></script>
</body>
</html> -->
<!-- <!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Drag and Drop Form Elements</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background-color: #f5f5f5;
      margin: 0;
      padding: 20px;
    }

    .form-canvas {
      border: 2px solid #ccc;
      padding: 20px;
      min-height: 300px;
      background-color: white;
    }

    .form-element {
      padding: 10px;
      margin-bottom: 10px;
      background-color: #e7e7e7;
      border: 1px solid #ccc;
      cursor: move;
    }

    .form-element:last-child {
      margin-bottom: 0;
    }

    .invisible {
      opacity: 0;
    }

    .drag-over {
      border: 2px dashed #007bff;
    }
  </style>
</head>
<body>

  <h2>Drag and Drop Form Elements</h2>
  <div id="formCanvas" class="form-canvas">
    <div class="form-element" draggable="true">Element 1</div>
    <div class="form-element" draggable="true">Element 2</div>
    <div class="form-element" draggable="true">Element 3</div>
    <div class="form-element" draggable="true">Element 4</div>
  </div>

  <script>
    let draggedElement;
    let dropTarget;

    // Get the form canvas
    const formCanvas = document.getElementById('formCanvas');

    // Enable drag for all elements in the form canvas
    formCanvas.addEventListener('dragstart', (e) => {
      if (e.target.classList.contains('form-element')) {
        draggedElement = e.target;
        setTimeout(() => e.target.classList.add('invisible'), 0); // Hide the element while dragging
        console.log('start')
      }
    });

    formCanvas.addEventListener('dragend', (e) => {
      if (draggedElement) {
        draggedElement.classList.remove('invisible'); // Show the element again
        console.log("end")
      }
    });

    // Allow dropping and position dragging over elements
    formCanvas.addEventListener('dragover', (e) => {
      e.preventDefault();
      if (e.target.classList.contains('form-element') && e.target !== draggedElement) {
        dropTarget = e.target;
        dropTarget.classList.add('drag-over');
        console.log('over')
      }
    });

    formCanvas.addEventListener('dragleave', (e) => {
      if (e.target.classList.contains('form-element')) {
        e.target.classList.remove('drag-over');
        console.log('leave')
      }
    });

    // Drop the element and reorder
    formCanvas.addEventListener('drop', (e) => {
      e.preventDefault();
      if (dropTarget && draggedElement !== dropTarget) {
        dropTarget.classList.remove('drag-over');
        
        // Insert the dragged element before or after the drop target
        const bounding = dropTarget.getBoundingClientRect();
        const offset = e.clientY - bounding.top;
        const position = offset > bounding.height / 2 ? 'after' : 'before';
        console.log('drop')

        if (position === 'after') {
          formCanvas.insertBefore(draggedElement, dropTarget.nextSibling);
          console.log('position after')
        } else {
          formCanvas.insertBefore(draggedElement, dropTarget);
        }

      }
    });
  </script>

</body>
</html> -->
<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>CRUD Operation on Headings</title>
  <style>
    .heading-box {
      margin: 10px 0;
      padding: 10px;
      border: 1px solid #ccc;
      display: flex;
      align-items: center;
      justify-content: space-between;
    }

    .heading-box h1 {
      margin: 0;
    }

    .btn {
      margin-left: 10px;
    }

    #heading-input-container {
      margin: 20px 0;
    }
  </style>
</head>
<body>

  <button id="add-heading-btn">Add Heading</button>

  <!-- Container for input and save button -->
  <div id="heading-input-container" style="display: none;">
    <input type="text" id="heading-input" placeholder="Enter heading text">
    <button id="save-heading-btn">Save Heading</button>
  </div>

  <!-- Container where headings will be displayed -->
  <div id="heading-container"></div>

  <script>
    const heading_input = document.getElementById('heading-input-container');
    let headingIdCounter = 0; // Initialize the counter for unique IDs
    let editingHeadingId = null; // Keep track of which heading is being edited

    // Function to generate a unique ID for each heading
    function generateUniqueId() {
      return `heading-${headingIdCounter++}`;
    }

    // Function to show the input field to add or edit a heading
    function showHeadingInput() {
      console.log('show heading')
      const inputContainer = document.getElementById('heading-input-container');
      inputContainer.style.display = 'block';
    }

    // Function to hide the input field
    function hideHeadingInput() {
      const inputContainer = document.getElementById('heading-input-container');
      inputContainer.style.display = 'none';
    }

    // Function to save or update a heading
    function saveHeading() {
      const headingText = document.getElementById('heading-input').value;

      if (!headingText) {
        alert("Please enter heading text.");
        return;
      }

      if (editingHeadingId) {
        // Update the heading if editing
        updateHeading(editingHeadingId, headingText);
      } else {
        // Create a new heading if not editing
        const uniqueId = generateUniqueId(); // Generate a unique ID
        addHeadingToLocalStorage(uniqueId, headingText);
        createHeadingElement(uniqueId, headingText);
      }

      // Clear the input field and hide the input container
      document.getElementById('heading-input').value = '';
      hideHeadingInput();
      editingHeadingId = null; // Reset the editing state
    }

    // Function to create and add the heading box to the DOM
    function createHeadingElement(id, text) {
      const headingBox = document.createElement('div');
      headingBox.className = 'heading-box';
      headingBox.setAttribute('id', id);

      const heading = document.createElement('h1');
      heading.innerText = text;

      // Create Edit button
      const editButton = document.createElement('button');
      editButton.className = 'btn';
      editButton.innerText = 'Edit';
      editButton.onclick = function () {
        editHeading(id);
      };

      // Create Delete button
      const deleteButton = document.createElement('button');
      deleteButton.className = 'btn';
      deleteButton.innerText = 'Delete';
      deleteButton.onclick = function () {
        deleteHeading(id);
      };

      headingBox.appendChild(heading);
      headingBox.appendChild(editButton);
      headingBox.appendChild(deleteButton);
      document.getElementById('heading-container').appendChild(headingBox);
    }

    // Function to edit a heading
    function editHeading(id) {
      const storedHeadings = JSON.parse(localStorage.getItem('headings')) || [];
      const heading = storedHeadings.find(heading => heading.id === id);

      if (heading) {
        // Pre-fill the input field with the existing heading text
        document.getElementById('heading-input').value = heading.text;
        showHeadingInput();
        editingHeadingId = id; // Set the ID of the heading being edited
      }
    }

    // Function to update a heading in the DOM and local storage
    function updateHeading(id, newText) {
      const headingBox = document.getElementById(id);
      headingBox.querySelector('h1').innerText = newText;

      // Update in local storage
      const storedHeadings = JSON.parse(localStorage.getItem('headings')) || [];
      const headingIndex = storedHeadings.findIndex(heading => heading.id === id);
      if (headingIndex !== -1) {
        storedHeadings[headingIndex].text = newText;
        localStorage.setItem('headings', JSON.stringify(storedHeadings));
      }
    }

    // Function to delete a heading
    function deleteHeading(id) {
      // Remove the heading from the DOM
      document.getElementById(id).remove();

      // Remove from local storage
      const storedHeadings = JSON.parse(localStorage.getItem('headings')) || [];
      const updatedHeadings = storedHeadings.filter(heading => heading.id !== id);
      localStorage.setItem('headings', JSON.stringify(updatedHeadings));
    }

    // Function to add a heading to local storage
    function addHeadingToLocalStorage(id, text) {
      const storedHeadings = JSON.parse(localStorage.getItem('headings')) || [];
      storedHeadings.push({ id, text });
      localStorage.setItem('headings', JSON.stringify(storedHeadings));
    }

    // Function to load headings from local storage on page load
    function loadHeadingsFromStorage() {
      const storedHeadings = JSON.parse(localStorage.getItem('headings')) || [];

      // Create headings from local storage data
      storedHeadings.forEach(headingData => {
        createHeadingElement(headingData.id, headingData.text);
      });

      // Update the counter to avoid ID duplication
      headingIdCounter = storedHeadings.length;
    }

    // Event listener to show the input field when the "Add Heading" button is clicked
    heading_input.addEventListener('click', showHeadingInput);

    // Event listener to save the heading when the "Save Heading" button is clicked
    document.getElementById('save-heading-btn').addEventListener('click', saveHeading);

    // Load headings from local storage on page load
    window.onload = loadHeadingsFromStorage;
  </script>

</body>
</html>
